(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{106:function(e,t,n){},108:function(e,t,n){},117:function(e,t){},119:function(e,t){},168:function(e,t,n){},170:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n.n(o),i=n(66),r=n.n(i),s=(n(77),n(4)),c=n(11),l=n(12),u=n(15),d=n(13),h=n(14),g=n(1),v=(n(79),function(e){return a.a.createElement("label",{className:"JsonLoader"},e.label,a.a.createElement("input",{accept:".geojson, .json",type:"file",onChange:function(t){var n=new FileReader;n.onload=function(t){var n=JSON.parse(t.target.result);e.onLoad(n)},n.readAsText(t.target.files[0])}}))}),f=n(67),p=n.n(f),m=n(68),b=n.n(m),y=n(16),S=n.n(y),w=n(8),j=n(36),O=function(e){var t=Object(w.a)(e,4),n=t[0],o=t[1],a=t[2],i=t[3];return{northWest:S.a.fromPointToLatLng({x:n,y:o}),southEast:S.a.fromPointToLatLng({x:n+a,y:o+i})}},B=function(e){return e.getAttribute("viewBox").split(" ").map(function(e){return parseFloat(e)})},C=function(e){return function(e){var t=Object(w.a)(e,4),n=t[0],o=t[1],a=t[2],i=t[3];return{minX:n,minY:o,maxX:n+a,maxY:o+i}}(B(e))};var L=function(e,t){var n=Object(w.a)(t,4),o=n[0],a=n[1],i=n[2],r=n[3];return e.setAttribute("viewBox","".concat(o," ").concat(a," ").concat(i," ").concat(r)),e},A=function(e){var t=B(e),n=Object(w.a)(t,4),o=n[0],a=n[1],i=n[2],r=n[3];i<r?(o-=(r-i)/2,i=r):(a-=(i-r)/2,r=i);return L(e,[o,a,i,r]),[o,a,i,r]},E=function(e,t){return function(e){var t=document.createElement("div");t.innerHTML=e;var n=t.querySelector("svg"),o=B(n);Array.from(n.childNodes).forEach(function(e){return e.setAttribute("mask","url(#viewBoxMask)")});var a=document.createElement("mask");a.setAttribute("id","viewBoxMask");var i=document.createElement("rect");return i.setAttribute("x",o[0]),i.setAttribute("y",o[1]),i.setAttribute("width",o[2]),i.setAttribute("height",o[3]),i.setAttribute("fill","white"),a.appendChild(i),n.insertBefore(a,n.firstChild),n.outerHTML}(function(e,t){var n=document.createElement("div");n.innerHTML=e;var o=n.querySelector("svg"),a=B(o),i=t/a[2],r=-a[0],c=-a[1];return L(o,[0,0,t,t]),Array.from(o.querySelectorAll("path")).forEach(function(e){var t=e.getAttribute("d"),n=Object(j.parse)(t).map(function(e){return function(e,t,n,o){var a=e.values;return 2===a.length&&(a[0]=(a[0]+n)*t,a[1]=(a[1]+o)*t),Object(s.a)({},e,{values:a})}(e,i,r,c)});e.setAttribute("d",Object(j.stringify)(n))}),o.outerHTML}(e,100))};var x=function(e,t,n){return(e-t)/(n-t)};n(106);function k(e,t){t.limitedViewBox&&L(e,t.limitedViewBox);var n=A(e);return{svg:{__html:e.outerHTML},svgElement:e,lastUsedViewBox:n}}function _(e,t){t.onChangeSvgDisplayed&&t.onChangeSvgDisplayed({svg:e.svg.__html,viewBox:e.lastUsedViewBox,latLonBounds:O(e.lastUsedViewBox),countryCode:t.countryInfo.country_code})}var T=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={loading:!0,svg:null},n.svgRef=a.a.createRef(),n.initSvg=n.initSvg.bind(Object(g.a)(Object(g.a)(n))),n.initRegion=n.initRegion.bind(Object(g.a)(Object(g.a)(n))),n.onRegionChange=n.onRegionChange.bind(Object(g.a)(Object(g.a)(n))),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.initSvgTimeout=setTimeout(this.initSvg)}},{key:"render",value:function(){return a.a.createElement("div",{className:"CountrySvg"},this.state.loading&&a.a.createElement("div",null," Loading... "),a.a.createElement("div",{className:"CountrySvg-inner"},this.props.allowSelectArea&&this.state.regionReady&&a.a.createElement("div",{className:"CountrySvg-areaSelector"},a.a.createElement(b.a,{maxRegions:1,regions:this.state.regions,constraint:!0,onChange:this.onRegionChange},a.a.createElement("div",{className:"CountrySvg-areaSelector-inner"}))),this.state.svg&&a.a.createElement("div",{dangerouslySetInnerHTML:this.state.svg,ref:this.svgRef}),this.canShowDot()&&a.a.createElement("div",{className:"CountrySvg-dot",style:this.getDotStyle()},"Lat ".concat(this.props.latLonToProject.lat,", Lon: ").concat(this.props.latLonToProject.lon))))}},{key:"componentWillUnmount",value:function(){this.initSvgTimeout&&(clearTimeout(this.initSvgTimeout),this.initSvgTimeout=null)}},{key:"initSvg",value:function(){this.initSvgTimeout=null;var e=this.getNewSvgElement();this.setState(k(e,this.props)),_(this.state,this.props),this.props.onInitSvgBoundaries&&this.props.onInitSvgBoundaries(B(e)),this.initRegion()}},{key:"initRegion",value:function(){var e={x:0,y:0,width:100,height:100,data:{}};this.setState({regions:[e],regionReady:!0,loading:!1}),this.props.onChangeAreaSelection&&this.props.onChangeAreaSelection(Object(s.a)({},e))}},{key:"onRegionChange",value:function(e){var t=e[0];t.isChanging&&(this.setState({regions:[Object(s.a)({},t)]}),this.props.onChangeAreaSelection&&this.props.onChangeAreaSelection(Object(s.a)({},t)))}},{key:"canShowDot",value:function(){return this.props.latLonToProject&&this.props.countryInfo&&this.svgRef.current}},{key:"getDotStyle",value:function(){var e=function(e,t,n){var o=t.minX,a=t.minY,i=t.maxX,r=t.maxY,s=S.a.fromLatLngToPoint({lat:e.lat,lng:e.lon}),c=s.x,l=s.y,u=x(c,o,i),d=x(l,a,r);return{x:u*n.width,y:d*n.height}}(this.props.latLonToProject,C(this.svgRef.current.querySelector("svg")),this.svgRef.current.getBoundingClientRect());return{top:"".concat(e.y,"px"),left:"".concat(e.x,"px")}}},{key:"getNewSvgElement",value:function(){var e=p()().styles({MultiPolygon:{fill:"#000000",stroke:"none"}}).projection(function(e){var t=S.a.fromLatLngToPoint({lat:e[1],lng:e[0]});return[t.x,t.y]}).data(this.props.countryInfo).render();return(new DOMParser).parseFromString(e,"image/svg+xml").querySelector("svg")}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.limitedViewBox&&t.lastUsedViewBox&&e.limitedViewBox.toString()!==t.lastUsedViewBox.toString()){var n=k(t.svgElement,e);return _(Object(s.a)({},t,n),e),n}return{}}}]),t}(o.Component),N=(n(108),function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).updateLat=n.updateLat.bind(Object(g.a)(Object(g.a)(n))),n.updateLon=n.updateLon.bind(Object(g.a)(Object(g.a)(n))),n.handleInitSvgBoundaries=n.handleInitSvgBoundaries.bind(Object(g.a)(Object(g.a)(n))),n.handleChangeAreaSelection=n.handleChangeAreaSelection.bind(Object(g.a)(Object(g.a)(n))),n.state={latLonToShow:"",lat:"40.415363",lon:"-3.707398"},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return a.a.createElement("div",{className:"Country"},a.a.createElement("div",{className:"Country-title"},this.props.countryInfo.properties.NAME),a.a.createElement("div",{className:"Country-maps"},a.a.createElement(T,{countryInfo:this.props.countryInfo,allowSelectArea:!0,latLonToProject:null,onInitSvgBoundaries:this.handleInitSvgBoundaries,onChangeAreaSelection:this.handleChangeAreaSelection}),this.state.limitedViewBox&&a.a.createElement(T,{countryInfo:this.props.countryInfo,latLonToProject:null,limitedViewBox:this.state.limitedViewBox,onChangeSvgDisplayed:this.props.onSvgChanged})),!1)}},{key:"updateLat",value:function(e){this.setState({lat:e.target.value})}},{key:"updateLon",value:function(e){this.setState({lon:e.target.value})}},{key:"handleInitSvgBoundaries",value:function(e){this.setState({svgBounds:e})}},{key:"handleChangeAreaSelection",value:function(e){var t=function(e,t){var n=Object(w.a)(e,4),o=n[0],a=n[1],i=n[2],r=n[3],s=i*t.width/100,c=r*t.height/100;return[o+t.x*i/100,a+t.y*r/100,s,c]}(this.state.svgBounds,e);this.setState({limitedViewBox:t})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return e.predefinedBounds&&t.limitedViewBox&&e.predefinedBounds.toString()!==t.limitedViewBox.toString()?{limitedViewBox:e.predefinedBounds}:{}}}]),t}(o.Component)),I=n(69),R=n.n(I),P=n(70),V=(n(21),function(e){return e.properties.NAME||e.properties.name});var J=n(71);n(168);var D=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(d.a)(t).call(this,e))).state={countries:[],filter:""},n.handleJsonLoad=n.handleJsonLoad.bind(Object(g.a)(Object(g.a)(n))),n.filterChanged=n.filterChanged.bind(Object(g.a)(Object(g.a)(n))),n.downloadAll=n.downloadAll.bind(Object(g.a)(Object(g.a)(n))),n.handleSvgChanged=n.handleSvgChanged.bind(Object(g.a)(Object(g.a)(n))),n.reset=n.reset.bind(Object(g.a)(Object(g.a)(n))),n.handleBoundsJsonLoad=n.handleBoundsJsonLoad.bind(Object(g.a)(Object(g.a)(n))),n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("h1",{className:"App-title"},"Country Shape Generator"),!!this.state.countries.length&&a.a.createElement("button",{className:"App-reset button",onClick:this.reset},"Reset and start again"),!!this.state.countries.length&&a.a.createElement("button",{className:"App-download button",onClick:this.downloadAll},"Download all")),!this.state.countries.length&&a.a.createElement("div",{className:"App-intro"},a.a.createElement(v,{onLoad:this.handleJsonLoad,label:"Load a GeoJsonFile with countries info: "})),!!this.state.countries.length&&a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:"App-tools"},a.a.createElement("div",null,a.a.createElement(v,{onLoad:this.handleBoundsJsonLoad,label:"Load custom bounds: "})),a.a.createElement("label",null,"Filter by:",a.a.createElement("input",{className:"App-tools-filter",value:this.state.filter,onChange:this.filterChanged}))),a.a.createElement("div",{className:"App-countries"},this.state.countries.filter(function(t){return function(e,t){if(!t)return!0;return-1!==V(e).toLowerCase().indexOf(t.toLowerCase())}(t,e.state.filter)}).map(function(t){return a.a.createElement(N,{key:t.country_code,countryInfo:t,predefinedBounds:e.getPredefinedBoundsForCountry(t.country_code),onSvgChanged:e.handleSvgChanged})}))))}},{key:"handleJsonLoad",value:function(e){this.setState({countries:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=e.map(function(e){return Object.assign({},e,{country_code:function(e){return e.properties.ISO_A2&&"-99"!==e.properties.ISO_A2?e.properties.ISO_A2:e.properties.FIPS_10_&&"-99"!==e.properties.FIPS_10_?e.properties.FIPS_10_:e.properties.WB_A2&&"-99"!==e.properties.WB_A2?e.properties.WB_A2:e.properties.iso_a2&&"-99"!==e.properties.iso_a2?e.properties.iso_a2:e.properties.fips_10_&&"-99"!==e.properties.fips_10_?e.properties.fips_10_:e.properties.wb_a2&&"-99"!==e.properties.wb_a2?e.properties.wb_a2:null}(e)})}).filter(function(e){return null!==e.country_code}).filter(function(e){return!function(e){var t=e.properties.TYPE||e.properties.type;return["Dependency","Indeterminate"].includes(t)}(e)});return t>-1&&(n=n.slice(0,t)),Object(P.sortBy)(n,function(e){return V(e).toLowerCase()})}(e.features)})}},{key:"filterChanged",value:function(e){this.setState({filter:e.target.value})}},{key:"downloadAll",value:function(){var e=Object.values(this.allSvgs).map(function(e){return Object(s.a)({},e,{svg:E(e.svg)})}),t=function(e){var t={};return e.forEach(function(e){t[e.countryCode]={latLonBounds:e.latLonBounds,viewBox:e.viewBox}}),JSON.stringify(t,void 0,2)}(e),n=new R.a;n.file("bounds.json",t),e.forEach(function(e){n.file("".concat(e.countryCode,".svg"),e.svg)}),n.generateAsync({type:"blob"}).then(function(e){Object(J.saveAs)(e,"svgs_and_bounds.zip")},function(e){console.warn(e)})}},{key:"handleSvgChanged",value:function(e){this.allSvgs=this.allSvgs||{},this.allSvgs[e.countryCode]=e}},{key:"reset",value:function(){this.setState({countries:[]})}},{key:"handleBoundsJsonLoad",value:function(e){this.setState({predefinedBounds:e})}},{key:"getPredefinedBoundsForCountry",value:function(e){return this.state.predefinedBounds&&this.state.predefinedBounds[e]?this.state.predefinedBounds[e].viewBox:null}}]),t}(o.Component),F=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}r.a.render(a.a.createElement(D,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL(".",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat(".","/service-worker.js");F?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):M(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):M(e)})}}()},72:function(e,t,n){e.exports=n(170)},77:function(e,t,n){},79:function(e,t,n){}},[[72,2,1]]]);
//# sourceMappingURL=main.89072e38.chunk.js.map